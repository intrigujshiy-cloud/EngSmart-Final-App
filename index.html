<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EngSmart Final App</title>
    <style>
        /* –°–¢–ò–õ–¨ –ö–û–ù–°–¢–†–£–ö–¢–û–†–ê (–∫–∞–∫ –Ω–∞ —Ç–≤–æ–µ–º –ª—é–±–∏–º–æ–º —Å–∫—Ä–∏–Ω–µ) */
        body { font-family: 'Segoe UI', sans-serif; background-color: #f4f7f9; margin: 0; display: flex; flex-direction: column; align-items: center; }
        .constructor-container { width: 100%; max-width: 900px; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); margin-top: 40px; }
        .section { background: #fff; border: 1px solid #edf2f7; border-radius: 12px; padding: 15px; margin-bottom: 20px; }
        .section-title { font-size: 0.75rem; font-weight: bold; color: #718096; text-transform: uppercase; margin-bottom: 10px; }
        textarea, input { width: 100%; padding: 10px; border: 2px solid #edf2f7; border-radius: 8px; box-sizing: border-box; font-size: 14px; }
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; }
        .btn-group { display: flex; gap: 15px; justify-content: center; margin: 20px 0; }
        .btn { padding: 12px 25px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; text-transform: uppercase; transition: 0.3s; }
        .btn-gen { background: #2ecc71; color: white; }
        .btn-test { background: #5d9cec; color: white; }
        .output-area { background: #2d3748; color: #a0aec0; padding: 15px; border-radius: 10px; font-family: monospace; font-size: 0.85rem; word-break: break-all; }

        /* –°–¢–ò–õ–¨ –ò–ì–†–´ (–ö–ê–†–¢–û–ß–ö–ò) */
        #game-view { display: none; width: 100vw; height: 100vh; background-size: cover; background-position: center; flex-direction: column; align-items: center; justify-content: center; }
        .card-container { perspective: 1000px; width: 300px; height: 400px; cursor: pointer; }
        .card { width: 100%; height: 100%; position: relative; transition: transform 0.6s; transform-style: preserve-3d; box-shadow: 0 15px 35px rgba(0,0,0,0.3); border-radius: 15px; }
        .card.is-flipped { transform: rotateY(180deg); }
        .card-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; flex-direction: column; align-items: center; justify-content: center; border-radius: 15px; background: white; padding: 20px; box-sizing: border-box; text-align: center; }
        .card-back { transform: rotateY(180deg); background: #f8f9fa; }
        .card-img { max-width: 100%; max-height: 200px; margin-bottom: 15px; border-radius: 10px; }
        .word { font-size: 24px; font-weight: bold; color: #333; }
    </style>
</head>
<body>

    <div id="editor-view" class="constructor-container">
        <h1 style="color: #4a90e2; text-align: center;">EngSmart 4.2 Pro</h1>
        <div class="section">
            <div class="section-title">1. –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ñ–æ–Ω (URL)</div>
            <input type="text" id="bgInp" value="https://images.unsplash.com/photo-1518709268805-4e9042af9f23">
        </div>
        <div class="grid">
            <div class="section"><div class="section-title">2. English</div><textarea id="enInp" rows="6">Apple</textarea></div>
            <div class="section"><div class="section-title">3. Russian</div><textarea id="ruInp" rows="6">–Ø–±–ª–æ–∫–æ</textarea></div>
            <div class="section"><div class="section-title">4. Images</div><textarea id="imgInp" rows="6">https://cdn-icons-png.flaticon.com/512/415/415733.png</textarea></div>
        </div>
        <div class="btn-group">
            <button class="btn btn-gen" onclick="generate()">üöÄ Get iFrame Code</button>
            <button class="btn btn-test" onclick="preview()">üëÅÔ∏è Test Game</button>
        </div>
        <div class="section">
            <div class="section-title">Your Code for Genially:</div>
            <div class="output-area" id="result">–ö–æ–¥ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å...</div>
        </div>
    </div>

    <div id="game-view">
        <div class="card-container" onclick="this.children[0].classList.toggle('is-flipped')">
            <div class="card">
                <div class="card-face card-front">
                    <img id="display-img" class="card-img" src="">
                    <div id="display-en" class="word"></div>
                </div>
                <div class="card-face card-back">
                    <div id="display-ru" class="word"></div>
                </div>
            </div>
        </div>
        <button class="btn" style="margin-top: 30px; background: white;" onclick="location.reload()">Back to Editor</button>
    </div>

    <script>
        function generate() {
            const bg = encodeURIComponent(document.getElementById('bgInp').value);
            const en = encodeURIComponent(document.getElementById('enInp').value.split('\n').join(','));
            const ru = encodeURIComponent(document.getElementById('ruInp').value.split('\n').join(','));
            const img = encodeURIComponent(document.getElementById('imgInp').value.split('\n').join(','));
            
            // –¢–µ–ø–µ—Ä—å —Å—Å—ã–ª–∫–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ —ç—Ç–æ—Ç –∂–µ —Ñ–∞–π–ª!
            const currentUrl = window.location.href.split('?')[0];
            const finalUrl = `${currentUrl}?play=true&bg=${bg}&en=${en}&ru=${ru}&img=${img}`;
            
            const iframe = `<iframe src="${finalUrl}" width="800" height="600" style="border:0; border-radius:15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1);" allowfullscreen></iframe>`;
            document.getElementById('result').innerText = iframe;
        }

        function preview() {
            const code = document.getElementById('result').innerText;
            if (code.includes('<iframe')) {
                const url = code.match(/src="([^"]+)"/)[1];
                window.open(url, "_blank");
            } else { alert("–°–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–æ–¥!"); }
        }

        // –ü–†–û–í–ï–†–ö–ê –†–ï–ñ–ò–ú–ê (–ò–ì–†–ê –ò–õ–ò –†–ï–î–ê–ö–¢–û–†)
        const params = new URLSearchParams(window.location.search);
        if (params.has('play')) {
            document.getElementById('editor-view').style.display = 'none';
            document.getElementById('game-view').style.display = 'flex';
            
            document.getElementById('game-view').style.backgroundImage = `url('${decodeURIComponent(params.get('bg'))}')`;
            document.getElementById('display-en').innerText = decodeURIComponent(params.get('en')).split(',')[0];
            document.getElementById('display-ru').innerText = decodeURIComponent(params.get('ru')).split(',')[0];
            document.getElementById('display-img').src = decodeURIComponent(params.get('img')).split(',')[0];
        }
    </script>
</body>
</html>
